A="2352001 2422001 2432001 2442001 2452001 2462001 2472001 2492001 2512001 2522001 2532001 2542001 2572001 2592001 2652001 2682001 2852001 2862001 2912001 2922001 2932001 2942001 2962001 2992001 3012001 3042001 3052001 3072001 3122001 3132001 3162001 3232001 3242001 3252001 3272001 3292001 3342001 3362001 3392001 3422001 3462001 3482001 3492001 3532001 3542001 4152001 4172001 4182001 4192001 4222001 4242001 4312001 4322001 4372001 4392001 4472001 4532001 4542001 4592001 5422001 5432001 5482001 5532001 5542001 5612001 7962001 7992001 8022001 8052001 8062001 8132001 8172001 8232001 8272001 8292001 8552001 9592001 9612001 9622001 9642001 9662001 9672001 9692001 9712001 9752001 9762001 9772001 9782001 9792001 9812001 9822001 9832001 9842001 9852001 9862001 9872001 9882001 9892001 9922001 9942001 9952001 10012001 10022001 10032001 10442001 10612001 10662001 10722001 10732001 10752001 10762001 10792001 10812001 10862001 11122001 11162001 11182001 11252001 11272001 11292001 11312001 11322001 11342001 11352001 11362001 11372001 11382001 11392001 11412001 11422001 11432001 11442001 11452001 11462001 11472001 11492001 11522001 11542001 11552001 11572001 11582001 11612001 11632001 11642001 11652001 11662001 11672001 11682001 11692001 11712001 11722001 11732001 11742001 11752001 11762001 11772001 11782001 11792001 11812001 11832001 11842001 11872001 11882001 11892001 11912001 11932001 11942001 11962001 11972001 11982001 11992001 12022001 12042001 12052001 12062001 12112001 12182001 12252001 12362001 12372001 12462001 12472001 12482001 12552001 12572001 12582001 12592001 12622001 12652001 12662001 12682001 12742001 12852001 13522001 13562001 13612001 13622001 13632001 13642001 13652001 13662001 13672001 13682001 13692001 13712001 13722001 13732001 13792001 13812001 13852001 14042001 14172001 14262001 14312001 14532001 14672001 14922001 15152001 15352001 15462001 15742001 15892001 15932001 16772001 16872001 16882001 17092001 17112001 17122001 17132001 17142001 17152001 17162001 17172001 17182001 17192001 17212001 17222001 17232001 17242001 17252001 17262001 17272001 17282001 17292001 17312001 17322001 17332001 17342001 17352001 17362001 17372001 17312001 17322001 17332001 17342001 17352001 17362001 17372001 17382001 17392001 17462001 17542001 18352001 18442001 18462001 18482001 18522001 18552001 18692001 18752001 18892001 18912001 18942001 18952001 19082001 19112001 19152001 20332001 20342001 20372001 20412001 20442001 20452001 20462001 20472001 20512001 20522001 20532001 20552001 20572001 20592001 20642001 20652001 20672001 20712001 20722001 20732001 20742001 20752001 20762001 20772001 20782001 20822001 20842001 20862001 20872001 20892001 20912001 20972001 21042001 21062001 21272001 21282001 21342001 21352001 21372001 21412001 21452001 21492001 21542001 22062001 22072001 22492001 22662001 22792001 22832001 22852001 22882001 22912001 22952001"
B= " 752001 1922001 2252001 2522001 2552001 2582001 2822001 2852001 3122001 3152001 3182001 3422001 3452001 3482001 3722001 3782001 4082001 4322001 4352001 4382001 4622001 4682001 5582001 7982001 8282001 8552001 8822001 8852001 9722001 9752001 9782001 10022001 10052001 10322001 10352001 10382001 10622001 10682001 10952001 10982001 11222001 11252001 11282001 11522001 11552001 11582001 11822001 11882001 12182001 12422001 12452001 12482001 12752001 12782001 13352001 13622001 13652001 13682001 13952001 13982001 14222001 14252001 14282001 14582001 15152001 15182001 15422001 15482001 16322001 17222001 17282001 17522001 17582001 17882001 18452001 18722001 18752001 19052001 19082001 19352001 19682001 20222001 20252001 20282001 20522001 20552001 20582001 20822001 20852001 20882001 21122001 21152001 21452001 21752001 21782001 22052001 22322001 22352001 22382001 22952001 22982001 23222001 23282001 24122001 24182001 24452001 24482001 24752001 25352001 25682001 25922001 25952001 25982001 26252001 26282001 29582001 32852001 32882001 35252001 36182001 36452001 36482001 37322001 37352001 37622001 37652001 37922001 37952001 37982001 38582001 39482001 39722001 39782001 40022001 40052001 40082001 40322001 40352001"
C = " 2352001  2422001  2432001  2442001  2452001  2462001  2472001  2492001  2512001  2522001  2532001 2542001  2572001  2592001  2652001  2682001  2852001  2862001  2912001  2922001  2932001  2942001 2962001  2992001  3012001  3042001  3052001  3072001  3122001  3132001  3162001  3232001  3242001 3252001  3272001  3292001  3342001  3362001  3392001  3422001  3462001  3482001  3492001  3532001 3542001  4152001  4172001  4182001  4192001  4222001  4242001  4312001  4322001  4372001  4392001 4472001  4532001  4542001  4592001  5422001  5432001  5482001  5532001  5542001  5612001  7962001 7992001  8022001  8052001  8062001  8132001  8172001  8232001  8272001  8292001  8552001  9592001 9612001  9622001  9642001  9662001  9672001  9692001  9712001  9752001  9762001  9772001  9782001 9792001  9812001  9822001  9832001  9842001  9852001  9862001  9872001  9882001  9892001  9922001 9942001  9952001 10012001 10022001 10032001 10442001 10612001 10662001 10722001 10732001 10752001 10762001 10792001 10812001 10862001 11122001 11162001 11182001 11252001 11272001 11292001 11312001 11322001 11342001 11352001 11362001 11372001 11382001 11392001 11412001 11422001 11432001 11442001 11452001 11462001 11472001 11492001 11522001 11542001 11552001 11572001 11582001 11612001 11632001 11642001 11652001 11662001 11672001 11682001 11692001 11712001 11722001 11732001 11742001 11752001 11762001 11772001 11782001 11792001 11812001 11832001 11842001 11872001 11882001 11892001 11912001 11932001 11942001 11962001 11972001 11982001 11992001 12022001 12042001 12052001 12062001 12112001 12182001 12252001 12362001 12372001 12462001 12472001 12482001 12552001 12572001 12582001 12592001 12622001 12652001 12662001 12682001 12742001 12852001 13522001 13562001 13612001 13622001 13632001 13642001 13652001 13662001 13672001 13682001 13692001 13712001 13722001 13732001 13792001 13812001 13852001 14042001 14172001 14262001 14312001 14532001 14672001 14922001 15152001 15352001 15462001 15742001 15892001 15932001 16772001 16872001 16882001 17032001 17072001 17112001 17282001 17292001 17312001 17322001 17332001 17342001 17352001 17362001 17372001 17382001 17392001 17462001 17542001 18352001 18442001 18462001 18482001 18522001 18552001 18692001 18752001 18892001 18912001 18942001 18952001 19082001 19112001 19152001 20332001 20342001 20372001 20412001 20442001 20452001 20462001 20472001 20512001 20522001 20532001 20552001 20572001 20592001 20642001 20652001 20672001 20712001 20722001 20732001 20742001 20752001 20762001 20772001 20782001 20822001 20842001 20862001 20872001 20892001 20912001 20972001 21042001 21062001 21272001 21282001 21342001 21352001 21372001 21412001 21452001 21492001 21542001 22062001 22072001 22492001 22662001 22792001 22832001 22852001 22882001 22912001 22952001 22982001 23022001 23042001 23082001 23132001 24032001 24042001 24052001 24062001 24072001 24082001 24342001 24472001 24512001 24522001 24692001 24792001 24862001 24942001 25222001 25662001 25692001 25832001 25842001 25852001 25862001 25872001 25882001 25892001 25912001 25922001 25932001 25942001 25952001 25972001 25992001 26012001 26022001 26032001 26042001 26092001 26112001 26122001 26142001 26152001 26172001 26182001 26212001 27192001 27292001 27312001 27322001 27342001 27352001 27362001 27372001 27732001 27962001 "
D = " 182001 752001 1922001 2252001 2522001 2552001 2582001 2822001 2852001 3122001 3152001 3182001 3422001 3452001 3482001 3722001 3782001 4082001 4322001 4352001 4382001 4622001 4682001 5582001 7982001 8282001 8522001 8552001 8822001 8852001 9722001 9752001 9782001 10022001 10052001 10082001 10322001 10352001 10382001 10622001 10682001 10952001 10982001 11222001 11252001 11282001 11522001 11552001 11582001 11822001 11852001 11882001 12122001 12152001 12182001 12422001 12452001 12482001 12752001 12782001 13352001 13622001 13652001 13682001 13922001 13952001 13982001 14222001 14252001 14282001 14582001 15152001 15182001 15422001 15482001 16322001 17222001 17282001 17522001 17582001 17882001 18452001 18722001 18752001 19022001 19052001 19082001 19352001 19682001 20222001 20252001 20282001 20522001 20552001 20582001 20822001 20852001 20882001 21122001 21152001 21452001 21722001 21752001 21782001 22052001 22322001 22352001 22382001 22952001 22982001 23222001 23282001 24122001 24452001 24482001 24752001 25352001 25682001 25922001 25952001 25982001 26252001 26282001 27782001 29582001 32852001 32882001 35252001 36182001 36422001 36452001 36482001 37322001 37352001 37622001 37652001 37922001 37952001 37982001 38582001 39422001 39482001 39722001 "
E = "  272001  2342001  2612001  2642001  2672001  2912001  2942001  2972001  3212001  3242001  3272001 3512001  3542001  3572001  4112001  4172001  4412001  4442001  4472001  5612001  8012001  8042001 8312001  8342001  8372001  8612001  8672001  9542001  9572001  9812001  9842001  9872001 10112001 10142001 10172001 10442001 10472001 10772001 11312001 11342001 11372001 11612001 11642001 11672001 11912001 11942001 11972001 12242001 12512001 12542001 12572001 12812001 12842001 13472001 13712001 13742001 13772001 14042001 14072001 14312001 14342001 14612001 14642001 14672001 14912001 14972001 15272001 15512001 15842001 15872001 16112001 16772001 17042001 17072001 17312001 17342001 17372001 18242001 18542001 18572001 18812001 18842001 19112001 19142001 19172001 19442001 20072001 20312001 20342001 20372001 20612001 20642001 20672001 20912001 20942001 20972001 21212001 21242001 21272001 21512001 21542001 21812001 21842001 22142001 22172001 22472001 22742001 22772001 23012001 23042001 23072001 23342001 23642001 23942001 23972001 24242001 24512001 24572001 24812001 24842001 24872001 25112001 25172001 25712001 25742001 26012001 26042001 26312001 " 
F = " 271001  2611001  2641001  2671001  2911001  2941001  2971001  3211001  3241001  3271001  3511001 3541001  3571001  4111001  4171001  4411001  4441001  4471001  5611001  8011001  8311001  8371001 8611001  8671001  9571001  9811001  9841001  9871001 10111001 10171001 10441001 10471001 11311001 11341001 11371001 11611001 11641001 11671001 11911001 11941001 11971001 12241001 12511001 12541001 12571001 12811001 13411001 13471001 13711001 13741001 13771001 14041001 14071001 14311001 14341001 14611001 14641001 14671001 14911001 14971001 15271001 15511001 15841001 15871001 16111001 16771001 17041001 17071001 17311001 17341001 17371001 18241001 18541001 18571001 18811001 18841001 19111001 19141001 19171001 19441001 20041001 20071001 20311001 20341001 20371001 20611001 20641001 20671001 20911001 20941001 20971001 21211001 21241001 21271001 21511001 21541001 21811001 21841001 22141001 22471001 22741001 22771001 23011001 23041001 23071001 23341001 23641001 23911001 23941001 23971001 24241001 24511001 24571001 24811001 24841001 24871001 25111001 25171001 25711001 25741001 26011001 26041001 26311001 26341001 26371001 27241001 27271001 27811001 27841001 27871001 29611001 32911001 32941001 33511001 33871001 34741001 36241001 36271001 36511001 36541001 36571001 38311001 38341001 39211001 39241001 39271001 39511001 39571001 39841001 39871001 40111001 40141001 40171001 40411001 40441001 "


if __name__ == "__main__":
    N = 150
    WRT = 'KAGGLE/CLICKTHRU/train'
    BADCHUNKS = A + B + C + D + E + F
    BADCHUNKS = [ x.strip() for x in BADCHUNKS.split(" ") if x.strip() ]
    BADCHUNKS = set(BADCHUNKS)
    BADCHUNKS = [ x for x in BADCHUNKS ]

    chunk_starts  = [ int(x.strip())-2000   for x in BADCHUNKS ]
    chunk_endings = [ int(x.strip())-2000+N for x in BADCHUNKS ]
    CHUNK_STARTS = dict(zip(chunk_starts,chunk_endings))
    CHUNK_ENDING = dict(zip(chunk_endings,chunk_starts))

    output_file = "bad_performance.csv"

    start = False
    chunk_id = None
    T = 0
    lineno = 0
    with open(output_file, 'w') as fp:
        for line in open('KAGGLE/CLICKTHRU/train'):
            if lineno == 0:
                lineno = lineno + 1
                continue

            if (lineno in CHUNK_STARTS):
                start = True
                chunk_id = lineno
                print '[[>>Chunk %10s started' % CHUNK_STARTS.pop(chunk_id)

            if start:
                T = T + 1
                fp.write(line)

            lineno = lineno + 1

            if (lineno in CHUNK_ENDING):
                start = False
                print '<<]]Chunk %10s ended' % chunk_id
                chunk_id = None
                if len(CHUNK_STARTS) == 0:
                    break

    print "%s lines written, %s lines examined" % (T, lineno)
